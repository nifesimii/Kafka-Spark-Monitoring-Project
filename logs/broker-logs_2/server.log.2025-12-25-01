[2025-12-25 01:19:59,866] INFO [RaftManager id=5] Completed transition to Unattached(epoch=24, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) from FollowerState(fetchTimeoutMs=2000, epoch=23, leader=kafka-controller-3:9093 (id: 3 rack: null) voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=34269, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-12-25 01:19:59,903] INFO [RaftManager id=5] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=24, leader=kafka-controller-1:9093 (id: 1 rack: null) voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=34269, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=24, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) (org.apache.kafka.raft.QuorumState)
[2025-12-25 01:19:59,917] INFO [RaftManager id=5] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=25, leader=kafka-controller-2:9093 (id: 2 rack: null) voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=34269, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from FollowerState(fetchTimeoutMs=2000, epoch=24, leader=kafka-controller-1:9093 (id: 1 rack: null) voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=34269, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-12-25 01:19:59,920] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Truncating to offset 34270 (kafka.log.UnifiedLog)
[2025-12-25 01:19:59,928] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Loading producer state till offset 34270 with message format version 2 (kafka.log.UnifiedLog$)
[2025-12-25 01:19:59,928] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Reloading from producer snapshot and rebuilding producer state from offset 34270 (kafka.log.UnifiedLog$)
[2025-12-25 01:19:59,929] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=34210, file=/tmp/kafka-logs/__cluster_metadata-0/00000000000000034210.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-12-25 01:19:59,938] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 34270 with 0 producer ids in 3 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-12-25 01:19:59,938] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Producer state recovery took 3ms for snapshot load and 6ms for segment recovery from offset 34270 (kafka.log.UnifiedLog$)
[2025-12-25 01:19:59,938] INFO [RaftManager id=5] Truncated to offset 34270 from Fetch response from leader 2 (org.apache.kafka.raft.KafkaRaftClient)
[2025-12-25 01:20:01,376] INFO [NodeToControllerChannelManager id=5 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-12-25 01:20:01,378] INFO [broker-5-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node kafka-controller-2:9093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-12-25 01:29:59,978] INFO [RaftManager id=5] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-12-25 01:29:59,988] INFO [RaftManager id=5] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-12-25 01:31:05,431] INFO [NodeToControllerChannelManager id=5 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-12-25 01:31:05,551] INFO [broker-5-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node kafka-controller-2:9093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-12-25 01:31:06,836] INFO [NodeToControllerChannelManager id=5 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-12-25 01:31:06,839] INFO [RaftManager id=5] Completed transition to Unattached(epoch=26, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) from FollowerState(fetchTimeoutMs=2000, epoch=25, leader=kafka-controller-2:9093 (id: 2 rack: null) voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=35590, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-12-25 01:31:07,838] INFO [BrokerLifecycleManager id=5] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-12-25 01:31:08,172] INFO [RaftManager id=5] Completed transition to Unattached(epoch=27, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) from Unattached(epoch=26, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) (org.apache.kafka.raft.QuorumState)
[2025-12-25 01:31:08,224] INFO [RaftManager id=5] Completed transition to Unattached(epoch=29, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) from Unattached(epoch=27, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) (org.apache.kafka.raft.QuorumState)
[2025-12-25 01:31:08,250] INFO [RaftManager id=5] Completed transition to Unattached(epoch=30, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) from Unattached(epoch=29, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) (org.apache.kafka.raft.QuorumState)
[2025-12-25 01:31:08,313] INFO [RaftManager id=5] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=30, leader=kafka-controller-1:9093 (id: 1 rack: null) voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=35590, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=30, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) (org.apache.kafka.raft.QuorumState)
[2025-12-25 01:31:08,316] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Truncating to offset 35590 (kafka.log.UnifiedLog)
[2025-12-25 01:31:08,333] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Loading producer state till offset 35590 with message format version 2 (kafka.log.UnifiedLog$)
[2025-12-25 01:31:08,333] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Reloading from producer snapshot and rebuilding producer state from offset 35590 (kafka.log.UnifiedLog$)
[2025-12-25 01:31:08,334] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=34270, file=/tmp/kafka-logs/__cluster_metadata-0/00000000000000034270.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-12-25 01:31:08,337] INFO [broker-5-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node kafka-controller-1:9093 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-12-25 01:31:08,356] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 35590 with 0 producer ids in 12 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-12-25 01:31:08,357] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Producer state recovery took 3ms for snapshot load and 20ms for segment recovery from offset 35590 (kafka.log.UnifiedLog$)
[2025-12-25 01:31:08,357] INFO [RaftManager id=5] Truncated to offset 35590 from Fetch response from leader 1 (org.apache.kafka.raft.KafkaRaftClient)
[2025-12-25 01:33:39,887] INFO [SnapshotGenerator id=5] Creating new KRaft snapshot file snapshot 00000000000000035892-0000000030 because we have waited at least 60 minute(s). (org.apache.kafka.image.publisher.SnapshotGenerator)
[2025-12-25 01:33:39,944] INFO [SnapshotEmitter id=5] Successfully wrote snapshot 00000000000000035892-0000000030 (org.apache.kafka.image.publisher.SnapshotEmitter)
[2025-12-25 01:54:59,162] INFO [RaftManager id=5] Disconnecting from node 1 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-12-25 01:54:59,182] INFO [RaftManager id=5] Cancelled in-flight FETCH request with correlation id 40739 due to node 1 being disconnected (elapsed time since creation: 899751ms, elapsed time since send: 899751ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-12-25 01:54:59,268] INFO [NodeToControllerChannelManager id=5 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-12-25 01:54:59,272] INFO [broker-5-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node kafka-controller-1:9093 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-12-25 01:54:59,291] INFO [RaftManager id=5] Completed transition to Unattached(epoch=31, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) from FollowerState(fetchTimeoutMs=2000, epoch=30, leader=kafka-controller-1:9093 (id: 1 rack: null) voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=36648, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-12-25 01:54:59,368] INFO [RaftManager id=5] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=31, leader=kafka-controller-3:9093 (id: 3 rack: null) voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=36648, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=31, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) (org.apache.kafka.raft.QuorumState)
[2025-12-25 01:54:59,423] INFO [broker-5-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node kafka-controller-3:9093 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
