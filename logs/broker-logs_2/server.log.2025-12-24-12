[2025-12-24 12:25:13,600] INFO [RaftManager id=5] Completed transition to Unattached(epoch=2, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) from FollowerState(fetchTimeoutMs=2000, epoch=1, leader=kafka-controller-1:9093 (id: 1 rack: null) voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=5986, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-12-24 12:25:13,627] INFO [NodeToControllerChannelManager id=5 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-12-24 12:25:13,686] INFO [RaftManager id=5] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=2, leader=kafka-controller-2:9093 (id: 2 rack: null) voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=5986, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=2, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) (org.apache.kafka.raft.QuorumState)
[2025-12-24 12:25:13,730] INFO [broker-5-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node kafka-controller-2:9093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-12-24 12:30:26,435] INFO [RaftManager id=5] Disconnecting from node 2 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-12-24 12:30:26,439] INFO [RaftManager id=5] Cancelled in-flight FETCH request with correlation id 6531 due to node 2 being disconnected (elapsed time since creation: 253456ms, elapsed time since send: 253455ms, throttle time: 0ms, request timeout: 2000ms) (org.apache.kafka.clients.NetworkClient)
[2025-12-24 12:30:26,479] INFO [RaftManager id=5] Completed transition to Unattached(epoch=3, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) from FollowerState(fetchTimeoutMs=2000, epoch=2, leader=kafka-controller-2:9093 (id: 2 rack: null) voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=6105, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-12-24 12:30:26,522] INFO [RaftManager id=5] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=3, leader=kafka-controller-3:9093 (id: 3 rack: null) voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=6105, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=3, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) (org.apache.kafka.raft.QuorumState)
[2025-12-24 12:30:26,534] INFO [RaftManager id=5] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=4, leader=kafka-controller-1:9093 (id: 1 rack: null) voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=6105, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from FollowerState(fetchTimeoutMs=2000, epoch=3, leader=kafka-controller-3:9093 (id: 3 rack: null) voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=6105, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-12-24 12:30:26,551] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Truncating to offset 6106 (kafka.log.UnifiedLog)
[2025-12-24 12:30:26,560] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Loading producer state till offset 6106 with message format version 2 (kafka.log.UnifiedLog$)
[2025-12-24 12:30:26,561] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Reloading from producer snapshot and rebuilding producer state from offset 6106 (kafka.log.UnifiedLog$)
[2025-12-24 12:30:26,565] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 6106 with 0 producer ids in 2 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-12-24 12:30:26,565] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Producer state recovery took 0ms for snapshot load and 4ms for segment recovery from offset 6106 (kafka.log.UnifiedLog$)
[2025-12-24 12:30:26,565] INFO [RaftManager id=5] Truncated to offset 6106 from Fetch response from leader 1 (org.apache.kafka.raft.KafkaRaftClient)
[2025-12-24 12:30:27,046] INFO [NodeToControllerChannelManager id=5 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-12-24 12:30:27,047] INFO [broker-5-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node kafka-controller-1:9093 (id: 1 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-12-24 12:30:59,006] INFO [RaftManager id=5] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=5, leader=kafka-controller-3:9093 (id: 3 rack: null) voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=6165, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from FollowerState(fetchTimeoutMs=2000, epoch=4, leader=kafka-controller-1:9093 (id: 1 rack: null) voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=6165, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-12-24 12:30:59,876] INFO [NodeToControllerChannelManager id=5 name=heartbeat] Client requested disconnect from node 1 (org.apache.kafka.clients.NetworkClient)
[2025-12-24 12:30:59,878] INFO [broker-5-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node kafka-controller-3:9093 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-12-24 12:35:22,274] INFO [RaftManager id=5] Completed transition to Unattached(epoch=6, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) from FollowerState(fetchTimeoutMs=2000, epoch=5, leader=kafka-controller-3:9093 (id: 3 rack: null) voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=6285, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-12-24 12:35:22,289] INFO [RaftManager id=5] Completed transition to Unattached(epoch=7, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) from Unattached(epoch=6, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) (org.apache.kafka.raft.QuorumState)
[2025-12-24 12:35:22,318] INFO [RaftManager id=5] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=7, leader=kafka-controller-2:9093 (id: 2 rack: null) voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=6285, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=7, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) (org.apache.kafka.raft.QuorumState)
[2025-12-24 12:35:22,893] INFO [NodeToControllerChannelManager id=5 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-12-24 12:35:22,895] INFO [broker-5-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node kafka-controller-2:9093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-12-24 12:40:53,618] INFO [RaftManager id=5] Completed transition to Unattached(epoch=8, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) from FollowerState(fetchTimeoutMs=2000, epoch=7, leader=kafka-controller-2:9093 (id: 2 rack: null) voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=6404, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-12-24 12:40:53,648] INFO [RaftManager id=5] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=8, leader=kafka-controller-1:9093 (id: 1 rack: null) voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=6404, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=8, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) (org.apache.kafka.raft.QuorumState)
[2025-12-24 12:40:53,662] INFO [RaftManager id=5] Completed transition to Unattached(epoch=9, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) from FollowerState(fetchTimeoutMs=2000, epoch=8, leader=kafka-controller-1:9093 (id: 1 rack: null) voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=6404, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-12-24 12:40:53,676] INFO [RaftManager id=5] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=9, leader=kafka-controller-3:9093 (id: 3 rack: null) voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=6404, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=9, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) (org.apache.kafka.raft.QuorumState)
[2025-12-24 12:40:53,685] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Truncating to offset 6405 (kafka.log.UnifiedLog)
[2025-12-24 12:40:53,694] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Loading producer state till offset 6405 with message format version 2 (kafka.log.UnifiedLog$)
[2025-12-24 12:40:53,695] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Reloading from producer snapshot and rebuilding producer state from offset 6405 (kafka.log.UnifiedLog$)
[2025-12-24 12:40:53,695] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=6106, file=/tmp/kafka-logs/__cluster_metadata-0/00000000000000006106.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-12-24 12:40:53,710] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 6405 with 0 producer ids in 2 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-12-24 12:40:53,711] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Producer state recovery took 12ms for snapshot load and 4ms for segment recovery from offset 6405 (kafka.log.UnifiedLog$)
[2025-12-24 12:40:53,711] INFO [RaftManager id=5] Truncated to offset 6405 from Fetch response from leader 3 (org.apache.kafka.raft.KafkaRaftClient)
[2025-12-24 12:40:54,493] INFO [NodeToControllerChannelManager id=5 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-12-24 12:40:54,496] INFO [broker-5-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node kafka-controller-3:9093 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-12-24 12:47:56,428] INFO [SnapshotGenerator id=5] Creating new KRaft snapshot file snapshot 00000000000000007247-0000000009 because we have waited at least 60 minute(s). (org.apache.kafka.image.publisher.SnapshotGenerator)
[2025-12-24 12:47:56,566] INFO [SnapshotEmitter id=5] Successfully wrote snapshot 00000000000000007247-0000000009 (org.apache.kafka.image.publisher.SnapshotEmitter)
[2025-12-24 12:50:53,817] INFO [RaftManager id=5] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-12-24 12:50:53,818] INFO [RaftManager id=5] Node 2 disconnected. (org.apache.kafka.clients.NetworkClient)
