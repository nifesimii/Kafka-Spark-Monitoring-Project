[2025-12-25 03:46:49,063] INFO [NodeToControllerChannelManager id=5 name=heartbeat] Disconnecting from node 3 due to request timeout. (org.apache.kafka.clients.NetworkClient)
[2025-12-25 03:46:51,807] INFO [NodeToControllerChannelManager id=5 name=heartbeat] Cancelled in-flight BROKER_HEARTBEAT request with correlation id 12560 due to node 3 being disconnected (elapsed time since creation: 4505ms, elapsed time since send: 4505ms, throttle time: 0ms, request timeout: 4500ms) (org.apache.kafka.clients.NetworkClient)
[2025-12-25 03:46:52,036] INFO [broker-5-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node kafka-controller-3:9093 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-12-25 03:46:52,172] INFO [BrokerLifecycleManager id=5] Unable to send a heartbeat because the RPC got timed out before it could be sent. (kafka.server.BrokerLifecycleManager)
[2025-12-25 03:46:53,220] INFO [NodeToControllerChannelManager id=5 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-12-25 03:46:53,243] INFO [broker-5-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node kafka-controller-3:9093 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-12-25 03:46:53,296] INFO [broker-5-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node kafka-controller-3:9093 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-12-25 03:46:53,315] INFO [NodeToControllerChannelManager id=5 name=heartbeat] Client requested disconnect from node 3 (org.apache.kafka.clients.NetworkClient)
[2025-12-25 03:46:53,326] INFO [broker-5-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node kafka-controller-3:9093 (id: 3 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-12-25 03:46:53,373] INFO [RaftManager id=5] Completed transition to Unattached(epoch=32, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) from FollowerState(fetchTimeoutMs=2000, epoch=31, leader=kafka-controller-3:9093 (id: 3 rack: null) voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=50007, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) (org.apache.kafka.raft.QuorumState)
[2025-12-25 03:46:53,405] INFO [RaftManager id=5] Completed transition to Unattached(epoch=34, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) from Unattached(epoch=32, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) (org.apache.kafka.raft.QuorumState)
[2025-12-25 03:46:53,511] INFO [RaftManager id=5] Completed transition to FollowerState(fetchTimeoutMs=2000, epoch=34, leader=kafka-controller-2:9093 (id: 2 rack: null) voters=[1, 2, 3], highWatermark=Optional[LogOffsetMetadata(offset=50007, metadata=Optional.empty)], fetchingSnapshot=Optional.empty) from Unattached(epoch=34, voters=[1, 2, 3], electionTimeoutMs=9223372036854775807) (org.apache.kafka.raft.QuorumState)
[2025-12-25 03:46:53,567] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Truncating to offset 50008 (kafka.log.UnifiedLog)
[2025-12-25 03:46:53,577] INFO [broker-5-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node kafka-controller-2:9093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-12-25 03:46:53,651] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Loading producer state till offset 50008 with message format version 2 (kafka.log.UnifiedLog$)
[2025-12-25 03:46:53,657] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Reloading from producer snapshot and rebuilding producer state from offset 50008 (kafka.log.UnifiedLog$)
[2025-12-25 03:46:53,665] INFO [ProducerStateManager partition=__cluster_metadata-0] Loading producer state from snapshot file 'SnapshotFile(offset=35590, file=/tmp/kafka-logs/__cluster_metadata-0/00000000000000035590.snapshot)' (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-12-25 03:46:53,668] INFO [NodeToControllerChannelManager id=5 name=heartbeat] Client requested disconnect from node 2 (org.apache.kafka.clients.NetworkClient)
[2025-12-25 03:46:53,697] INFO [broker-5-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node kafka-controller-2:9093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-12-25 03:46:53,755] INFO [broker-5-to-controller-heartbeat-channel-manager]: Recorded new KRaft controller, from now on will use node kafka-controller-2:9093 (id: 2 rack: null) (kafka.server.NodeToControllerRequestThread)
[2025-12-25 03:46:53,829] INFO [ProducerStateManager partition=__cluster_metadata-0] Wrote producer snapshot at offset 50008 with 0 producer ids in 26 ms. (org.apache.kafka.storage.internals.log.ProducerStateManager)
[2025-12-25 03:46:53,849] INFO [UnifiedLog partition=__cluster_metadata-0, dir=/tmp/kafka-logs] Producer state recovery took 91ms for snapshot load and 97ms for segment recovery from offset 50008 (kafka.log.UnifiedLog$)
[2025-12-25 03:46:53,850] INFO [RaftManager id=5] Truncated to offset 50008 from Fetch response from leader 2 (org.apache.kafka.raft.KafkaRaftClient)
[2025-12-25 03:48:38,637] INFO [SnapshotGenerator id=5] Creating new KRaft snapshot file snapshot 00000000000000050217-0000000034 because we have waited at least 60 minute(s). (org.apache.kafka.image.publisher.SnapshotGenerator)
[2025-12-25 03:48:38,726] INFO [SnapshotEmitter id=5] Successfully wrote snapshot 00000000000000050217-0000000034 (org.apache.kafka.image.publisher.SnapshotEmitter)
[2025-12-25 03:56:53,568] INFO [RaftManager id=5] Node 3 disconnected. (org.apache.kafka.clients.NetworkClient)
[2025-12-25 03:56:53,901] INFO [RaftManager id=5] Node 1 disconnected. (org.apache.kafka.clients.NetworkClient)
